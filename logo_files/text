Text=function(n,t,i,r,u,f,e,o,s){var h=this;h.width;h.height;h.oldwidth;h.oldheight;h.color=r.clone();h.format=new Textformat(n);h.format.font=t;h.drawningboard=u;h.group=h.drawningboard.workspace.g();h.path=h.group.path();h.svg=h.group.text(0,0,"");h.upperlayer=h.group.rect(0,0,0,0);h.path.attr("fill","none");h.group.attr("pointer-events","fill");h.x=f;h.y=e;h.realposition=!1;h.offset={x:0,y:0};h.scale=i?i:1;h.scalex=h.scale;h.scaley=h.scale;h.flipx=0;h.flipy=0;h.rotation=0;h.alpha=1;h.id=o;h.subid=s;h.groupid=0;h.statelist=[];h.curvedline={};h.curvedline.enabled=!1;h.curvedline.type="up";h.curvedline.start=!1;h.curvedline.x;h.curvedline.y;h.curvedline.left={};h.curvedline.left.x=0;h.curvedline.left.y=0;h.curvedline.anchorleft={};h.curvedline.anchorleft.x=0;h.curvedline.anchorleft.y=0;h.curvedline.anchorright={};h.curvedline.anchorright.x=0;h.curvedline.anchorright.y=0;h.curvedline.right={};h.curvedline.right.x=0;h.curvedline.right.y=0;h.curvedline.startwidth;h.curvedline.startheight;h.type="text";h.index;h.name;h.iconname;h.companytext=!1;h.start=function(){h.group.addClass("svg-text");h.realposition||(h.x=h.x?h.drawningboard.width/2+(h.x-h.offset.x/2)*h.scalex:h.drawningboard.width/2,h.y=h.y?h.drawningboard.height/2+(h.y-h.offset.y/2)*h.scaley:h.drawningboard.height/2);h.group.attr({cursor:"move"});h.update();h.curvedline.enabled||(h.curvedline.left.x=-(h.width/2),h.curvedline.left.y=h.height-20,h.curvedline.anchorleft.x=-20,h.curvedline.anchorleft.y=h.height-21,h.curvedline.anchorright.x=20,h.curvedline.anchorright.y=h.height-21,h.curvedline.right.x=h.width/2,h.curvedline.right.y=h.height-20,h.curvedline.startwidth=h.width,h.curvedline.startheight=h.height+20);h.index=h.drawningboard.selector.getnewindex(h.id,h.type);h.subid?(h.name=h.drawningboard.api.dictionary.element_text+" "+h.id+"."+h.subid,h.iconname=h.drawningboard.api.dictionary.element_logo+" "+h.id):h.name=h.drawningboard.api.dictionary.element_text+" "+h.id;h.drawningboard.selector.watch(h)};h.enabled=function(){return h.alpha};h.finish=function(){h.group.remove()};h.translateoffset=function(){var n={x:0,y:0};return n.y=h.height/2*h.scaley-h.height*h.flipy*h.scaley,n.x=h.curvedline.enabled?h.width/2*h.scalex-h.width*h.flipx*h.scalex:h.format.alignment=="center"?0:h.format.alignment=="left"?0:0,n};h.update=function(){var t,i,n;h.subid?(h.name=h.drawningboard.api.dictionary.element_text+" "+h.id+"."+h.subid,h.iconname=h.drawningboard.api.dictionary.element_logo+" "+h.id):h.name=h.drawningboard.api.dictionary.element_text+" "+h.id;h.path.attr({d:"M"+h.curvedline.left.x+","+h.curvedline.left.y+" C"+h.curvedline.anchorleft.x+","+h.curvedline.anchorleft.y+" "+h.curvedline.anchorright.x+","+h.curvedline.anchorright.y+" "+h.curvedline.right.x+","+h.curvedline.right.y});t=h.svg.attr("fill");t&&t.id&&(i=$(h.drawningboard.workspace.node).find("#"+t.id),i.length==1&&i.remove());h.svg.attr({"font-size":h.format.size,"font-style":h.format.italic||h.format.font=="Molle"?"italic":"","font-weight":h.format.bold?"bold":"","font-family":h.format.font,textpath:undefined,fill:h.color.getsvgcolor(h.drawningboard.workspace),"text-anchor":"middle"});h.svg.node.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve");h.svg.node.textContent=h.format.text;h.curvedline.enabled&&(h.svg.attr({dy:"",textpath:h.path,x:"",y:""}),h.curvedline.type!="up"&&h.svg.attr({dy:h.curvedline.startheight*.6}),$(h.svg.node.childNodes[0]).attr("startOffset","50%"));n=h.svg.getBBox();h.curvedline.enabled?h.upperlayer.attr({width:n.width,height:n.height,x:n.cx-n.width/2,y:n.cy-n.height/2,fill:"none"}):(h.oldWidth=h.width,h.oldHeight=h.height,h.width=n.width,h.height=n.height,h.upperlayer.attr({width:0,height:0}),h.svg.attr({dy:h.height*.75}),h.oldWidth!=h.width&&(h.format.alignment=="left"?h.x-=(h.oldWidth-h.width)*h.scalex/2:h.format.alignment=="right"&&(h.x+=(h.oldWidth-h.width)*h.scalex/2)));h.group.attr({transform:"translate("+parseInt(h.x-h.translateoffset().x)+","+parseInt(h.y-h.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(h.rotation))+" "+h.translateoffset().x+" "+h.translateoffset().y+") scale("+h.scalex*(h.flipx?-1:1)+","+h.scaley*(h.flipy?-1:1)+")",opacity:h.alpha});h.alpha?(h.group.addClass("svg-visible"),h.group.removeClass("svg-hidden")):(h.group.removeClass("svg-visible"),h.group.addClass("svg-hidden"))}}